(function(n){function r(a){if(1500>a){var c=2E3/11;300>a&&(a=300);a=(a-300)/1200;return t({S:c+(300-c)*(1-a),U:(30+(1900/33-30)*a)/100,F:(50+(2300/33-50)*a)/100})}2500<a&&(a=2500);return t({S:(5E3-2*a)/11,U:7*a/16500-2/33,F:a/3300+8/33})}function t(a){var c=a.F*a.U,b=a.S/60,d=c*(1-Math.abs(b%2-1)),e=0,f=0,g=0;switch(!0){case 5<=b:e=c;g=d;break;case 4<=b:e=d;g=c;break;case 3<=b:f=d;g=c;break;case 2<=b:f=c;g=d;break;case 1<=b:e=d;f=c;break;case 0<=b:e=c,f=d}return{r:Math.floor(255*(e+a.F-c)),m:Math.floor(255*
(f+a.F-c)),j:Math.floor(255*(g+a.F-c))}}function p(a,c,b,d,e){var f=e-d+1,g=(d+e)/2;a=a[e]-a[d-1];c=c[e]-c[d-1];var h=(e*(e+1)*(e+e+1)-d*(d-1)*(d+d-1))/6;return[(c-g*a)/(h-f*g*g),1-Math.pow((f*c-f*g*a)/Math.sqrt((f*h-f*f*g*g)*(f*(b[e]-b[d-1])-a*a)),6)]}function u(a,c,b){return 0>=b?a:1<=b?c:a+(c-a)*b}function q(a,c,b,d,e){return 0>=e?"rgb("+a.toString()+","+c.toString()+","+b.toString()+")":1<=e?"rgb("+(255).toString()+","+(255).toString()+","+d.toString()+")":"rgb("+Math.round(a+(255-a)*e).toString()+
","+Math.round(c+(255-c)*e).toString()+","+Math.round(b+(d-b)*e).toString()+")"}function h(a){if("string"!==typeof a)console.log("BPM.create(): id cannot be null");else{a=document.getElementById(a);if(!a||"CANVAS"!==a.tagName.toUpperCase())return console.log("BPM.create(): id should correspond to a <canvas> element"),!1;this.aa(a);this.canvas=a;this.a=a.getContext("2d");this.C=Date.now();this.D=!1;this.T=-1;this.V=0;this.l=!1;this.B=this.L="---";this.M=-1;this.b=[];this.w=[];this.w[-1]=0;this.A=[];
this.A[-1]=0;this.v=[];this.v[-1]=0;this.K=[];this.R=[];this.N=this.o=!1;this.s=function(a){return function(){a.ca()}}(this);l(this.s);this.h=!1;this.c=this.G=this.J=this.u=-1;this.I=[0,0];a.addEventListener("mousedown",function(a){return function(b){a.Y(b)}}(this));a.addEventListener("mousemove",function(a){return function(b){a.Z(b)}}(this));a.addEventListener("mouseup",function(a){return function(b){a.$(b)}}(this))}}var l=n.requestAnimationFrame||n.mozRequestAnimationFrame||n.webkitRequestAnimationFrame||
n.msRequestAnimationFrame;h.font="Droid Sans Mono, Source Code Pro, Menlo, Courier New, Monospace";h.prototype.aa=function(a){a.width=a.parentElement.clientWidth;a.height=240};h.prototype.O=function(){var a="---";if(8<this.b.length){for(var c=[0,0,0,0,0,0,0,0],b=0;8>b;++b)c[b]=this.b[this.b.length-1-b]-this.b[this.b.length-2-b];c.sort(function(a,b){return a-b});c[7]-c[0]<=.5*c[7]&&(a=Math.round((6E4/((c[3]+c[4])/2)+6E4/((this.b[this.b.length-1]-this.b[this.b.length-9])/8))/2).toString())}for(;3>a.length;)a=
" "+a;this.L=this.B;this.B=a};h.prototype.ba=function(a){-1===this.M&&(this.M=a);a-=this.M;this.b.push(a);this.O();this.w[this.b.length-1]=this.w[this.b.length-2]+a;this.A[this.b.length-1]=this.A[this.b.length-2]+a*(this.b.length-1);this.v[this.b.length-1]=this.v[this.b.length-2]+a*a;a=[];var c=[],b,d,e;a[1]=8>this.b.length?Infinity:p(this.w,this.A,this.v,2,this.b.length-3)[1];c[1]=-1;for(var f=2;10>f;++f){d=Infinity;e=-1;for(var g=0;g<this.b.length-8;++g)b=this.K[g][f-1]+p(this.w,this.A,this.v,g+
3,this.b.length-3)[1],d>b&&(d=b,e=g);a[f]=d;c[f]=e}this.K[this.b.length-1]=a;this.R[this.b.length-1]=c};h.prototype.W=function(){for(var a=Infinity,c=-1,b=1;10>b;++b)a>this.K[this.b.length-1][b]&&(a=this.K[this.b.length-1][b],c=b);a=[];for(b=this.b.length-1;-1!==b;b=this.R[b][c--])a.push(b);a.push(0);a.reverse();this.g=[];for(b=1;b<a.length;++b)this.g.push([a[b],6E4/p(this.w,this.A,this.v,a[b-1]+2,a[b]-2)[0]])};h.prototype.P=function(a){var c=this.canvas.clientWidth,b=this.canvas.clientHeight,d=Math.ceil(c/
160)+1;this.a.fillStyle="#bbbb88";for(var e=this.D?-1:0;e<Math.min(d,this.b.length-1);++e){this.a.beginPath();var f=c-160*e-80+(this.D?-1:1)*Math.max(0,Math.pow(1-a/200,3))*160+10,g=b-b*(this.D&&-1===e?this.T-this.b[this.b.length-1]:this.b[this.b.length-1-e]-this.b[this.b.length-2-e])/1500;if(this.o)if(f=c-160*e-70,300>a)var m=a/300,g=g+(b+10-g)*m*m*(3.5*m-2.5);else g=b+10;else this.l&&(f=c-160*e-70);this.a.arc(f,g,10,0,2*Math.PI);this.a.fill();this.a.fillRect(f-3.09,g,6.18,b-g)}this.a.fillStyle=
this.o?"rgba(135, 135, 85, "+(1-a/100).toString()+")":"#999955";this.a.font="34px "+h.font;this.a.textBaseline="bottom";d=this.a.measureText("Est.");this.a.fillText("Est.",c-d.width-6,.5*b);this.a.font="64px "+h.font;this.a.textBaseline="top";d=this.a.measureText("m");for(e=0;3>e;++e)!this.o&&!this.l&&200>a&&this.B[e]!==this.L[e]?(f=this.B[e]<this.L[e]?1:-1,this.a.fillStyle="rgba(135, 135, 85, "+(1-a/200).toString()+")",g=a/200,this.a.fillText(this.L[e],c-d.width*(3-e)-6,.5*b+20*f*g*g*g),this.a.fillStyle=
"rgba(135, 135, 85, "+(a/200).toString()+")",g=a/200,this.a.fillText(this.B[e],c-d.width*(3-e)-6,.5*b-20*f*(1-(1-(1-g)*(1-g)*(1-g))))):this.a.fillText(this.B[e],c-d.width*(3-e)-6,.5*b)};h.prototype.X=function(a){var c=this.canvas.clientWidth,b=this.canvas.clientHeight;this.a.fillStyle="rgba(0, 0, 0, 0.5)";if(!this.f){this.f=[4];this.i=[b-4];for(var d=1;d<this.b.length;++d)this.f[d]=4+(c-8)*d/(this.b.length-1),this.i[d]=b-4-(b-8)*this.b[d]/this.b[this.b.length-1]}for(var e=Math.min(this.b.length,Math.floor((a-
300)/1200*this.b.length)),d=0;d<e;++d)this.a.beginPath(),this.a.arc(this.f[d],this.i[d],4,0,2*Math.PI),this.a.fill(),0<d&&(this.a.beginPath(),this.a.moveTo(this.f[d-1],this.i[d-1]),this.a.lineTo(this.f[d],this.i[d]),this.a.stroke());if(1500>a){var f=(a-300)/1200*this.b.length-e;this.a.beginPath();this.a.arc(this.f[e],this.i[e],4*f,0,2*Math.PI);this.a.fill();0<e&&(this.a.beginPath(),this.a.moveTo(this.f[d-1],this.i[d-1]),this.a.lineTo(u(this.f[d-1],this.f[d],f),u(this.i[d-1],this.i[d],f)),this.a.stroke())}else if(2E3<
a){for(var g=this.h?Math.max(0,1-(Date.now()-this.J)/180):Math.max(0,Math.min(1,(Date.now()-this.c-3E3)/180)),e=Math.min(this.g.length-1,Math.floor((a-2E3)/180)),m=0,l,d=0;d<=e;++d){var f=Math.min(1,(a-(2E3+180*d))/180),k=r(10*this.g[d][1]+420);l=this.g[d][0]/(this.b.length-1)*c;this.a.fillStyle="rgba("+k.r+","+k.m+","+k.j+", "+(.3*f*g).toString()+")";this.a.fillRect(m,0,l-m,b);this.a.fillStyle="rgba(0, 0, 0, "+(.66*f*g).toString()+")";this.a.font="44px "+h.font;this.a.textBaseline="middle";k=Math.round(this.g[d][1]).toString();
f=this.a.measureText(k).width;this.a.fillText(k,(m+l-f)/2,b*(.382+.05*d));this.a.font="24px "+h.font;k=(this.g[d][1]-Math.round(this.g[d][1])).toFixed(2);"-"!==k[0]&&(k="+"+k);f=this.a.measureText(k).width;this.a.fillText(k,(m+l-f)/2,b*((5>=d?.502:.262)+.05*d));m=l}a>2E3+180*this.g.length&&(this.N=!0)}if(this.h||this.c>=Date.now()-3E3)this.h?a={r:0,m:0,j:0}:(a=r(6E4/this.I[0]*10+420),c=(Date.now()-this.c)/180,e={r:0,m:0,j:0},a=0>=c?e:1<=c?a:{r:Math.round(e.r+(a.r-e.r)*c),m:Math.round(e.m+(a.m-e.m)*
c),j:Math.round(e.j+(a.j-e.j)*c)}),k=a,a=this.h?1:Math.min(1,(3E3-Date.now()+this.c)/180),this.a.fillStyle="rgba("+k.r+","+k.m+","+k.j+", "+(.3*a).toString()+")",c=Math.min(this.u,this.G),this.a.fillRect(c,0,Math.max(this.u,this.G)-c,b),this.h||(a=Math.min(a,(Date.now()-this.c)/180),this.a.fillStyle="rgba(0, 0, 0, "+(.66*a).toString()+")",this.a.font="44px "+h.font,k=(6E4/this.I[0]).toFixed(2),f=this.a.measureText(k).width,this.a.fillText(k,(this.u+this.H-f)/2,b*(.382+.05*d)),this.a.font="24px "+
h.font,k="err "+(100*this.I[1]).toFixed(2)+"%",f=this.a.measureText(k).width,this.a.fillText(k,(this.u+this.H-f)/2,b*((5>=d?.502:.262)+.05*d)))};h.prototype.Y=function(a){this.N&&(a=a.clientX-this.canvas.offsetLeft,this.h=!0,this.G=this.u=a,this.J=Date.now(),this.c>=Date.now()-3E3&&(this.J-=180),this.c=-1,l(this.s))};h.prototype.Z=function(a){this.h&&(this.G=a.clientX-this.canvas.offsetLeft)};h.prototype.$=function(a){if(this.N){var c=this.canvas.clientWidth;a=a.clientX-this.canvas.offsetLeft;this.h=
!1;this.c=Date.now();this.H=a;a=Math.min(this.b.length-1,Math.max(0,Math.ceil((Math.min(this.u,this.H)-4)/((c-8)/(this.b.length-1)))));c=Math.min(this.b.length-1,Math.max(0,Math.floor((Math.max(this.u,this.H)-4)/((c-8)/(this.b.length-1)))));c<a+1&&(this.c-=3E3);this.I=p(this.w,this.A,this.v,a,c)}};h.prototype.ca=function(){var a=this.canvas.clientWidth,c=this.canvas.clientHeight,b=Date.now()-this.C;this.a.clearRect(0,0,a,c);this.o?this.a.fillStyle=q(255,255,204,255,b/100):0===this.b.length?this.a.fillStyle=
"#ccddaa":1!==this.b.length||this.D?this.l?160>=b?this.a.fillStyle=q(238,238,170,204,Math.abs(80-b)/80):this.a.fillStyle="#ffffcc":this.a.fillStyle="#ffffcc":this.a.fillStyle=q(204,221,170,204,b/100);this.a.fillRect(0,0,a,c);0!==this.b.length&&(this.o?(400<b?this.X(b-100):this.P(b),(b<2200+180*this.g.length||this.h||this.c>Date.now()-4E3)&&l(this.s)):(this.P(b),200>b&&l(this.s)))};h.prototype.pat=function(){this.o||(this.C=Date.now(),this.D=!1,this.l&&(this.V=this.l-this.b[this.b.length-1]-this.M,
this.l=!1),this.ba(this.C-this.V),l(this.s))};h.prototype.undo=function(){1>=this.b.length||this.o||(this.l=!1,this.C=Date.now(),this.D=!0,this.T=this.b[this.b.length-1],this.b.pop(),this.O(),l(this.s))};h.prototype["break"]=function(){0!==this.b.length&&(this.C=this.l=Date.now(),l(this.s))};h.prototype.finish=function(){8>this.b.length||(this.o=!0,this.C=Date.now(),this.W(),l(this.s))};n.bpm=function(a){return new h(a)}})(window);
